{% extends 'base.html' %}

{% block title %}Order Details - AgriConnect{% endblock %}

{% block content %}
<h1 style="text-align:center; margin-top:1rem; color: var(--secondary-green);">Order Details</h1>

<div style="max-width: 900px; margin: auto; margin-top:1.5rem;">

  <!-- Order Summary Card -->
  <div class="product-card" style="background: #f0fdf4; border: 2px solid var(--primary-green);">
    <p><strong>User:</strong> {{ order.user }}</p>
    <p><strong>Status:</strong> 
      <span style="color: {{ '#f39c12' if order.status == 'Pending' else '#2ecc71' if order.status == 'Completed' else '#e74c3c' }}; font-weight:bold;">
        {{ order.status }}
      </span>
    </p>
    <p><strong>Payment Method:</strong> {{ order.payment_method | upper }}</p>
    <p><strong>Grand Total:</strong> ₹{{ order.grandtotal }}</p>

    <!-- Approve Button -->
    <div style="margin-top:1rem; text-align:center;">
      {% if order.status != 'Completed' %}
        <a class="btn" style="background: #2ecc71;" href="{{ url_for('approve_order', order_id=order._id) }}">✅ Approve Order</a>
      {% else %}
        <span style="color: #2ecc71; font-weight:bold;">✅ Approved</span>
      {% endif %}
    </div>
  </div>

  <h2 style="margin-top:2rem; color: var(--primary-green); text-align:center;">Items in this Order</h2>

  <div class="products-container">
    {% for item in order["items"] %}
      <div class="product-card">
        {% if item.image %}
          <img src="{{ url_for('static', filename=item.image) }}" alt="{{ item.name }}">
        {% else %}
          <img src="{{ url_for('static', filename='images/placeholder.png') }}" alt="{{ item.name }}">
        {% endif %}
        <h3>{{ item.name }}</h3>
        <p>Price: ₹{{ item.price }}</p>
        <p>Quantity: {{ item.quantity }}</p>
        <p><strong>Total: ₹{{ item.price * item.quantity }}</strong></p>
      </div>
    {% else %}
      <p style="text-align:center; margin-top:2rem;">No items found in this order.</p>
    {% endfor %}
  </div>

  <div style="text-align:center; margin-top:2rem;">
    <a class="btn" href="{{ url_for('admin_dashboard') }}">⬅ Back to Dashboard</a>
  </div>
</div>
{% endblock %}
